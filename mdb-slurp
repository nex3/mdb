#!/usr/bin/env python
import sys
import os
import traceback
from mdb import Database

server = 'http://localhost:5984/'
name = 'mdb'

for path in sys.argv[1:]:
    db = Database(server, name)
    if os.path.isfile(path):
        db.record(path)
        break
    for (dirname, _, files) in os.walk(path):
        try: db.add_many([os.path.join(dirname, f) for f in files])
        except Exception:
            print "Error when importing %s:" % dirname
            traceback.print_exc()
